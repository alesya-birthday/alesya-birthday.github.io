<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Приглашение на день рождения</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
</head>
<body>
    <div class="cloud-shape cloud-shape-1"></div>
    <div class="cloud-shape cloud-shape-2"></div>
    <div class="cloud-shape cloud-shape-3"></div>
   
  
    <header class="header">
        <img src="img/happy.png" alt="Happy" class="happy-banner" style="display:block;margin:0 auto 0.5rem auto;max-width:180px;">
        <div class="countdown" id="countdown">
            <img src="img/transparent/12_no_bg.png" alt="Звезда" class="countdown-star" style="width:32px;vertical-align:middle;margin-right:0.3em;">
            <span id="countdown-text"></span>
            <img src="img/transparent/12_no_bg.png" alt="Звезда" class="countdown-star" style="width:32px;vertical-align:middle;margin-left:0.3em;">
        </div>
        <h1 id="invitation-title" class="title">Привет! Это приглашение на мой праздник!</h1>
    </header>

    <main>
        <section class="hero" style="background: url('img/2.jpg') center/cover no-repeat;">
            <div class="birthday-number">
                <img src="img/2.png" class="balloon-2" alt="2">
                <img src="img/4.png" class="balloon-4" alt="4">
            </div>
            <div class="date-calendar">
                <div class="calendar-widget">
                    <div class="calendar-header">Июнь 2025</div>
                    <div class="calendar-days">
                        <span>Вс</span><span>Пн</span><span>Вт</span><span>Ср</span><span>Чт</span><span>Пт</span><span>Сб</span>
                    </div>
                    <div class="calendar-grid">
                        <span class="calendar-cell">1</span>
                        <span class="calendar-cell">2</span>
                        <span class="calendar-cell">3</span>
                        <span class="calendar-cell">4</span>
                        <span class="calendar-cell">5</span>
                        <span class="calendar-cell">6</span>
                        <span class="calendar-cell">7</span>
                        <span class="calendar-cell">8</span>
                        <span class="calendar-cell">9</span>
                        <span class="calendar-cell">10</span>
                        <span class="calendar-cell">11</span>
                        <span class="calendar-cell">12</span>
                        <span class="calendar-cell">13</span>
                        <span class="calendar-cell">14</span>
                        <span class="calendar-cell">15</span>
                        <span class="calendar-cell">16</span>
                        <span class="calendar-cell">17</span>
                        <span class="calendar-cell">18</span>
                        <span class="calendar-cell">19</span>
                        <span class="calendar-cell">20</span>
                        <span class="calendar-cell">21</span>
                        <span class="calendar-cell">22</span>
                        <span class="calendar-cell">23</span>
                        <span class="calendar-cell">24</span>
                        <span class="calendar-cell">25</span>
                        <span class="calendar-cell">26</span>
                        <span class="calendar-cell">27</span>
                        <span class="calendar-cell">28</span>
                        <span class="calendar-cell selected">29</span>
                        <span class="calendar-cell">30</span>
                    </div>
                </div>
            </div>
            <img src="img/transparent/2_no_bg.png" class="sticker sticker-megaphone" alt="Мегафон">
        </section>

        <section class="timeline" style="background: rgba(255,255,255,0.82); background-image: url('img/45e.jpg'); background-size: cover;">
            <h2>Программа дня</h2>
            <div class="roadmap">
                <div class="roadmap-step">
                    <span class="roadmap-icon"><i class="fas fa-users"></i></span>
                    <div class="roadmap-content">
                        <div class="roadmap-time">15:00–16:00</div>
                        <div class="roadmap-title">Сбор гостей</div>
                    </div>
                </div>
                <div class="roadmap-step">
                    <span class="roadmap-icon"><i class="fas fa-utensils"></i></span>
                    <div class="roadmap-content">
                        <div class="roadmap-time">16:00–18:00</div>
                        <div class="roadmap-title">Торжество, ужин</div>
                    </div>
                </div>
                <div class="roadmap-step">
                    <span class="roadmap-icon"><i class="fas fa-gamepad"></i></span>
                    <div class="roadmap-content">
                        <div class="roadmap-time">18:00–00:00</div>
                        <div class="roadmap-title">Общение, игры</div>
                    </div>
                </div>
            </div>
        </section>

        <section class="location" style="">
            <h2>Место проведения</h2>
            <p>г. Минск, ул. Аннаева 28А</p>
            <div class="map">
                <script type="text/javascript" charset="utf-8" async src="https://api-maps.yandex.ru/services/constructor/1.0/js/?um=constructor%3A55b8879a899bf08c86c73b2f3e175b8c8addf0d0beb794f6504f871634744e07&amp;width=100%25&amp;height=490&amp;lang=ru_RU&amp;scroll=false"></script>
            </div>
            
        </section>

        <section class="gifts">
            <h2>Подарки</h2>
            <p>Подарки по желанию вашего ❤️ Приходите просто так! Я жду всех!</p>
            <a href="https://wishlist.by/user/02737d7f-d9f1-4d4b-981d-2fca79f52920?listId=c57d4624-b980-4e5c-8957-61cbe60fc8f5" class="wishlist-btn" target="_blank">Виш-лист идей</a>
            
        </section>

        <section class="dresscode" style="">
            <h2>Дресс-код</h2>
            <div class="color-palette">
                <div class="color blue"></div>
                <div class="color white"></div>
                <div class="color light-blue"></div>
                <div class="color silver"></div>
            </div>
            <p>+ весёлое настроение!</p>
        </section>

        <section class="gallery" style="background: url('img/20.jpg') center/cover no-repeat;">
            <h2>Я очень жду вас!</h2>
            <!-- <div class="slider" id="gallery-slider"></div> -->
            <div class="gallery-row gallery-row-1">
                <div class="gallery-item"><img src="img/img5.jpg" alt="Gallery Photo 1" loading="lazy"></div>
                <div class="gallery-item"><img src="img/img6.jpg" alt="Gallery Photo 2" loading="lazy"></div>
                <div class="gallery-item"><img src="img/img7.jpg" alt="Gallery Photo 3" loading="lazy"></div>
                <div class="gallery-item"><img src="img/img8.jpg" alt="Gallery Photo 4" loading="lazy"></div>
            </div>
            <div class="gallery-row gallery-row-2">
                <div class="gallery-item"><img src="img/img9.jpg" alt="Gallery Photo 5" loading="lazy"></div>
                <div class="gallery-item"><img src="img/img10.jpg" alt="Gallery Photo 6" loading="lazy"></div>
                <div class="gallery-item"><img src="img/img4.jpg" alt="Gallery Photo 7" loading="lazy"></div>
                <div class="gallery-item"><img src="img/img11.jpg" alt="Gallery Photo 8" loading="lazy"></div>
            </div>
            <div class="gallery-row gallery-row-3">
                <div class="gallery-item"><img src="img/gallery2.jpg" alt="Gallery Photo 9" loading="lazy"></div>
                <div class="gallery-item"><img src="img/gallery3.jpg" alt="Gallery Photo 10" loading="lazy"></div>
                <div class="gallery-item"><img src="img/gallery1.jpg" alt="Gallery Photo 11" loading="lazy"></div>
                <div class="gallery-item"><img src="img/gallery4.jpg" alt="Gallery Photo 12" loading="lazy"></div>
            </div>
        </section>

        <section class="rsvp" style="background: url('') bottom/contain no-repeat;">
            <h2>Подтвердите присутствие до 15.06</h2>
            <form id="rsvp-form" class="rsvp-form" action="https://formspree.io/f/manjnzpl" method="POST">
                <input type="text" name="name" placeholder="Ваше имя" required>
                <div class="attendance">
                    <label>
                        <input type="radio" name="attendance" value="yes" required>
                        Приду
                    </label>
                    <label>
                        <input type="radio" name="attendance" value="no" required>
                        Не смогу
                    </label>
                </div>
                <div class="allergies">
                    <select id="allergies-select" name="allergies">
                        <option value="no">Нет аллергий</option>
                        <option value="yes">Есть аллергии</option>
                    </select>
                    <textarea id="allergies-details" name="allergies_details" placeholder="Укажите аллергии" style="display: none;"></textarea>
                </div>
                <div class="song-input-container">
                    <img src="img/11-removebg-preview.png" alt="Музыкальная нота" class="song-icon">
                    <input type="text" name="song" placeholder="Песня, которую хочу услышать на">
                </div>
                <input type="hidden" name="_subject" value="Новое подтверждение на день рождения">
                <input type="hidden" name="_next" value="https://yourwebsite.com/thanks.html">
                <button type="submit">Отправить</button>
            </form>
        
            
        </section>
    </main>

    <footer>
        <p>С любовью, <span class="name">Алеся</span></p>
    </footer>

    <!-- Модальное окно для просмотра фото -->
    <div id="photo-modal" class="modal">
        <span class="close-button">&times;</span>
        <img class="modal-content" id="modal-image">
    </div>

    <!-- <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&loading=async&defer"></script> -->
    <script src="script.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
          console.log('DOMContentLoaded fired.');
          // Получаем параметры из URL
          const urlParams = new URLSearchParams(window.location.search);
          let guestName = urlParams.get('name');

          // Если нет name=, пробуем взять просто ?Имя
          if (!guestName && window.location.search.length > 1) {
            // Убираем ? и декодируем
            try {
                guestName = decodeURIComponent(window.location.search.slice(1));
            } catch (e) {
                console.error('Failed to decode URI component:', e);
                guestName = null; // Сбросить guestName при ошибке декодирования
            }
          }

          console.log('guestName from URL:', guestName);

          function escapeHtml(str) {
            return str.replace(/</g, "&lt;").replace(/>/g, "&gt;");
          }

          function formatTitle(name) {
            if (!name) return 'Привет! Это приглашение на мой праздник!';
            // Если имя без пробелов, но с большой буквы в середине (например, СергейНаталья)
            if (/^[А-ЯЁ][а-яё]+[А-ЯЁ][а-яё]+$/.test(name)) {
              // Разбиваем на два имени
              const parts = name.split(/(?=[А-ЯЁ])/);
              if (parts.length === 2) {
                return `Привет, ${parts[0]} и ${parts[1]}! Приглашаю вас на мой праздник!`;
              }
            }
            // Если имя содержит пробел или запятую, тоже считаем как два
            if (/\s|,/.test(name)) {
              const parts = name.split(/\s+|,+/).filter(Boolean);
              if (parts.length === 2) {
                return `Привет, ${parts[0]} и ${parts[1]}! Приглашаю вас на мой праздник!`;
              }
            }
            // Обычное имя
            return `Привет, ${name}! Приглашаю тебя на мой праздник!`;
          }

          if (guestName) {
            const safeName = escapeHtml(guestName);
            const titleElement = document.getElementById('invitation-title');
            if (titleElement) {
                titleElement.textContent = formatTitle(safeName);
            }
            localStorage.setItem('guestName', safeName);
          } else {
            const savedName = localStorage.getItem('guestName');
            if (savedName) {
              const titleElement = document.getElementById('invitation-title');
              if (titleElement) {
                  titleElement.textContent = formatTitle(savedName);
              }
            }
          }

          function formatNameForInput(name) {
            if (!name) return '';
            // Если имя без пробелов, но с большой буквы в середине (например, СергейНаталья)
            if (/^[А-ЯЁ][а-яё]+[А-ЯЁ][а-яё]+$/.test(name)) {
              // Разбиваем на два имени
              const parts = name.split(/(?=[А-ЯЁ])/);
              if (parts.length === 2) {
                return `${parts[0]} и ${parts[1]}`;
              }
            }
            // Если имя содержит пробел или запятую, тоже считаем как два
            if (/\s|,/.test(name)) {
              const parts = name.split(/\s+|,+/).filter(Boolean);
              if (parts.length === 2) {
                return `${parts[0]} и ${parts[1]}`;
              }
            }
            // Обычное имя
            return name;
          }

          // Обработка поля ввода имени для подстановки из URL
          const nameInput = document.querySelector('.rsvp-form input[name="name"]');
          if (nameInput) {
            console.log('Name input element found:', nameInput);
            const savedName = localStorage.getItem('guestName');
            if (savedName) {
                nameInput.value = formatNameForInput(savedName);
                console.log('Name input value set to:', nameInput.value);
            }
          } else {
            console.log('Name input element not found.');
          }

          // Обработка поля аллергий
          document.getElementById('allergies-select').addEventListener('change', function() {
              const detailsField = document.getElementById('allergies-details');
              detailsField.style.display = this.value === 'yes' ? 'block' : 'none';
          });


        }); // Конец DOMContentLoaded

        // --- Попап окно для фото ---
        const modal = document.getElementById("photo-modal");
        const modalImg = document.getElementById("modal-image");
        const closeButton = document.getElementsByClassName("close-button")[0];

        // Получаем все изображения в галерее
        const galleryImages = document.querySelectorAll('.gallery-row img');

        galleryImages.forEach(img => {
          img.addEventListener('click', function() {
            modal.style.display = "flex"; // Показываем модальное окно
            modalImg.src = this.src; // Устанавливаем источник изображения в модальном окне
          });
        });

        // Закрываем модальное окно при клике на кнопку закрытия (x)
        closeButton.onclick = function() {
          modal.style.display = "none";
        }

        // Закрываем модальное окно при клике вне изображения
        window.onclick = function(event) {
          if (event.target == modal) {
            modal.style.display = "none";
          }
        }

      </script>
</body>
</html> 